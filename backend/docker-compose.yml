version: "3.9"

services:
  backend:
    build:
      context: .
      args:
        # 默认使用官方源，必要时可临时覆盖为镜像源
        PIP_INDEX_URL: https://pypi.org/simple
        PIP_EXTRA_INDEX_URL: https://pypi.org/simple
        PIP_TRUSTED_HOST: pypi.org files.pythonhosted.org
    container_name: bi-ads-backend
    env_file:
      - .env
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      # 强制生产模式；如需调试可在 .env 覆盖
      - DEBUG=False
      # gunicorn worker 数，按需调整
      - WORKERS=4
    ports:
      - "7800:7800"
    restart: unless-stopped
